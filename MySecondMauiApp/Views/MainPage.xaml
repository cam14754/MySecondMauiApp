<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MySecondMauiApp.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:MySecondMauiApp.Model"
    xmlns:viewmodel="clr-namespace:MySecondMauiApp"
    Title="{Binding Title}"
    x:DataType="viewmodel:MainPageViewModel">

    <Grid
        Margin="0"
        BackgroundColor="{AppThemeBinding Light={StaticResource LightBackground},
                                          Dark={StaticResource DarkBackground}}"
        ColumnDefinitions="*, *, *, *, *"
        RowDefinitions="60, * , Auto">

        <!--  Header Buttons  -->
        <Button
            Grid.Column="0"
            Style="{StaticResource TopButton}"
            Text="Edit" />
        <Button
            Grid.Column="1"
            Style="{StaticResource TopButton}"
            Text="Duplicate" />
        <Button
            Grid.Column="2"
            Margin="4"
            Style="{StaticResource TopButton}"
            Text="Download" />
        <Button
            Grid.Column="3"
            Style="{StaticResource TopButton}"
            Text="Rename" />
        <Button
            Grid.Column="4"
            Style="{StaticResource TopButton}"
            Text="Delete" />

        <!--  Line seperator between header and content  -->
        <BoxView
            Grid.Row="0"
            Grid.ColumnSpan="5"
            BackgroundColor="Gray"
            HeightRequest="1"
            VerticalOptions="End" />

        <CollectionView
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.ColumnSpan="5"
            ItemsSource="{Binding Rocks}"
            SelectedItem="{Binding SelectedRock}"
            SelectionMode="Single">


            <CollectionView.ItemsLayout>
                <LinearItemsLayout ItemSpacing="10" Orientation="Vertical" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="model:Rock">
                    <!--  TEMPLATE ROOT  -->
                    <Border
                        x:Name="Root"
                        Margin="10"
                        HeightRequest="125"
                        Style="{StaticResource CardView}">
                        <Grid ColumnDefinitions="125,*">
                            <Border
                                HeightRequest="110"
                                HorizontalOptions="Center"
                                Stroke="{StaticResource Primary}"
                                StrokeShape="RoundRectangle 10"
                                StrokeThickness="2"
                                VerticalOptions="Center"
                                WidthRequest="110">
                                <Image
                                    Aspect="Fill"
                                    HeightRequest="110"
                                    HorizontalOptions="Center"
                                    Source="{Binding Image}"
                                    VerticalOptions="Center"
                                    WidthRequest="110" />
                            </Border>

                            <VerticalStackLayout
                                Grid.Column="1"
                                Padding="10"
                                VerticalOptions="Center">
                                <Label Style="{StaticResource LargeLabelBold}" Text="{Binding Name}" />
                                <Label Style="{StaticResource MediumLabel}" Text="{Binding Details}" />
                            </VerticalStackLayout>
                        </Grid>

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState Name="Normal" />

                                <VisualState Name="Selected">
                                    <VisualState.Setters>
                                        <Setter TargetName="Root" Property="Border.Stroke" Value="{StaticResource Accent}" />
                                        <Setter TargetName="Root" Property="Border.StrokeThickness" Value="5" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Button
            Grid.Row="2"
            Grid.ColumnSpan="5"
            Command="{Binding AddRockTestCommand}"
            Style="{StaticResource BigButton}"
            Text="+" />

    </Grid>

</ContentPage>
